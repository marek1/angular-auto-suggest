"use strict";var autoSuggestComponent=angular.module("autoSuggestComponent",[]).service("autoSuggestComponentService",["$http",function(e){this.retrieveResults=function(t,r){if("undefined"==typeof t||!t)return!1;switch(t.type){case"GET":return e.get(t.base+t.query+r+t.fragment);case"POST":return e.post(t.base+t.query+r+t.fragment,r)}}}]).controller("autoSuggestComponentController",["$scope","autoSuggestComponentService",function(e,t){e.searchTerm="",e.active=-1,e.hideResultList=!0,e.loading=!1,e.error=!1,e.search=function(){e.searchTerm.toString().length>=e.ctrl.noOfCharactersTyped&&(e.searchResults=[],t.retrieveResults(e.ctrl.url,e.searchTerm).then(function(t){"object"==typeof t&&t.length>0?e.searchResults=t:"object"==typeof t&&"object"==typeof t.data&&t.data.length>0&&(e.searchResults=t.data),e.searchResults.length>0?(e.hideResultList=!1,e.error=!1):(e.hideResultList=!0,e.error=!0)},function(){e.hideResultList=!0,e.error=!0}))},e.selectActive=function(){e.hideResultList=!0,e.searchTerm="",e.active>-1?(e.ctrl.result=e.searchResults[e.active],e.active=-1):e.error=!0},e.resetResults=function(){e.hideResultList=!0,e.searchResults=[],e.active=-1}}]).directive("autoSuggestComponent",function(){return{restrict:"EA",controller:"autoSuggestComponentController",controllerAs:"ctrl",bindToController:!0,scope:{url:"=",typeaheadTitle:"=",result:"=",noOfResultsShown:"=",noOfCharactersTyped:"="},template:'<div class="auto-suggest-component"><form><input type="text" id="searchTerm" name="searchTerm" data-ng-model="searchTerm" data-ng-change="search()" placeholder="What place are you looking for?" value="" autocomplete="off" required></form><div data-ng-show="hideResultList"><p>NOTE : Type at least {{ctrl.noOfCharactersTyped}} characters</p></div><div class="results" data-ng-show="!hideResultList"><div class="result" data-ng-class="{ \'active\' : $index == active}" data-ng-repeat="result in searchResults |  limitTo:ctrl.noOfResultsShown">{{result[ctrl.typeaheadTitle]}}</div></div><div class="error" data-ng-show="error">Nothing found</div></div>',link:function(e,t,r){t.bind("keyup",function(t){13===t.keyCode?e.$apply(function(){e.selectActive()}):27===t.keyCode?e.$apply(function(){e.hide=!0}):(8===t.keyCode||46===t.keyCode)&&e.$apply(function(){e.resetResults()})}),t.bind("keydown",function(t){(13===t.keyCode||27===t.keyCode)&&t.preventDefault(),40===t.keyCode&&(t.preventDefault(),e.$apply(function(){e.active++})),38===t.keyCode&&(t.preventDefault(),e.$apply(function(){e.active--}))})}}});